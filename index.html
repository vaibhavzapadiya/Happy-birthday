import { Component } from '@angular/core';

@Component({
    selector: 'app-employee',
    templateUrl: './employee.component.html',
    styleUrls: ['./employee.component.css'],
})
export class EmployeeComponent {
    addform = this.fb.group({
        name: [''],
        email: [''],
        department: [''],
    });

    employees = [];
    editmode = false;
    errmsg = '';
    selectedIndex = -1;

    constructor(private fb: FormBuilder) {}

    onSubmit() {
        if (this.addform.valid) {
            if (this.editmode) {
                this.employees[this.selectedIndex] = this.addform.value;
                this.editmode = false;
            } else {
                this.employees.push(this.addform.value);
            }
            this.addform.reset();
        } else {
            this.errmsg = 'Please fill all fields correctly.';
        }
    }

    editemployee(index: number) {
        this.selectedIndex = index;
        this.addform.setValue(this.employees[index]);
        this.editmode = true;
        const modal = new bootstrap.Modal('#editModal');
        modal.show();
    }

    updateEmployee() {
        this.employees[this.selectedIndex] = this.addform.value;
        const modal = bootstrap.Modal.getInstance('#editModal');
        modal.hide();
    }

    openDeleteModal(index: number) {
        this.selectedIndex = index;
        const modal = new bootstrap.Modal('#deleteModal');
        modal.show();
    }

    deleteemployee(index: number) {
        this.employees.splice(index, 1);
        const modal = bootstrap.Modal.getInstance('#deleteModal');
        modal.hide();
    }

    cancelEdit() {
        this.editmode = false;
        this.addform.reset();
    }
}