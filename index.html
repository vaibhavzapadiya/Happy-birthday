import { Injectable } from '@angular/core';

export interface Feedback {
  customerName: string;
  feedbackMessage: string;
  feedbackRating: number;
}

@Injectable({
  providedIn: 'root',
})
export class FeedbackserviceService {
  feedbacklist: Feedback[] = [];
  filteredfeedback: Feedback[] | null = null;

  constructor() {}

  submitFeedback(feedback: Feedback) {
    this.feedbacklist.push(feedback);
    this.filteredfeedback = null; // Reset filtering when a new feedback is added
  }

  updateFeedback(editindex: number, feedback: Feedback) {
    if (editindex >= 0 && editindex < this.feedbacklist.length) {
      this.feedbacklist[editindex] = feedback;
      this.filteredfeedback = null; // Reset filtering when feedback is updated
    }
  }

  deleteFeedback(id: number) {
    if (id >= 0 && id < this.feedbacklist.length) {
      this.feedbacklist.splice(id, 1);
      this.filteredfeedback = null; // Reset filtering after deletion
    }
  }

  getFeedback(): Feedback[] {
    // Return filtered feedback if filtering is active
    return this.filteredfeedback || this.feedbacklist;
  }

  findFilteredFeedback(value: string) {
    const searchTerm = value.trim().toLowerCase();
    this.filteredfeedback = this.feedbacklist.filter((feedback) =>
      feedback.customerName.toLowerCase().includes(searchTerm)
    );
  }
}