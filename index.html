submit() {
  if (this.userForm.valid) {
    if (this.editemode && this.editindex !== null) {
      const currentStatus = this.userForm.get('status')?.value;

      // Check if the user is changing the status to 'active'
      if (currentStatus === 'active') {
        this.userservice.getusers().subscribe(obs => {
          this.userlist = obs.filter(x => x.status === 'active');

          // Check if the current user is already active
          const isAlreadyActive = this.userlist.some(user => user.id === this.editindex);

          // Validate only if the user is not already active
          if (!isAlreadyActive && this.userlist.length >= 10) {
            this.errmsg = 'You cannot have more than 10 active users';
          } else {
            this.saveUserChanges();
          }
        });
      } else {
        this.saveUserChanges();
      }
    } else {
      // Add new user logic
      this.userservice.adduser(this.userForm.value).subscribe(() => {
        this.userservice.getusers().subscribe(() => {
          this.router.navigate(['user-list']);
        });
      });
    }
  } else {
    this.errmsg = 'Please fill all the fields';
  }
}

// Helper method to save changes for editing mode
saveUserChanges() {
  if (this.editindex !== null) {
    this.userservice.edituser(this.editindex, this.userForm.value).subscribe(() => {
      this.userservice.getusers().subscribe(() => {
        this.router.navigate(['user-list']);
      });
    });
  }
}