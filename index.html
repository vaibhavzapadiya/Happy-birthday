import { Component, FormArray, FormBuilder, FormGroup, Validators } from '@angular/core';

@Component({
  selector: 'app-student-admission-form',
  templateUrl: './student-admission-form.component.html',
  styleUrls: ['./student-admission-form.component.css'],
})
export class StudentAdmissionFormComponent {
  studentForm: FormGroup;

  constructor(private fb: FormBuilder) {
    this.studentForm = this.fb.group({
      firstName: ['', Validators.required],
      middleName: ['', Validators.required],
      lastName: ['', Validators.required],
      dob: ['', Validators.required],
      placeOfBirth: ['', Validators.required],
      firstLanguage: ['', Validators.required],
      city: ['', Validators.required],
      state: ['', Validators.required],
      country: ['', Validators.required],
      pin: ['', [Validators.required, Validators.pattern('^[0-9]{6}$')]],
      fatherFullName: ['', Validators.required],
      fatherEmail: ['', [Validators.required, Validators.email]],
      fatherEducation: ['', Validators.required],
      fatherProfession: ['', Validators.required],
      fatherDesignation: ['', Validators.required],
      fatherPhone: ['', [Validators.required, Validators.pattern('^[0-9]{10}$')]],
      motherFullName: ['', Validators.required],
      motherEmail: ['', [Validators.required, Validators.email]],
      motherEducation: ['', Validators.required],
      motherProfession: ['', Validators.required],
      motherDesignation: ['', Validators.required],
      motherPhone: ['', [Validators.required, Validators.pattern('^[0-9]{10}$')]],
      emergencyContacts: this.fb.array([]),
    });
  }

  get emergencyContacts() {
    return this.studentForm.get('emergencyContacts') as FormArray;
  }

  addEmergencyContact() {
    this.emergencyContacts.push(
      this.fb.group({
        relation: ['', Validators.required],
        emergencyNumber: ['', [Validators.required, Validators.pattern('^[0-9]{10}$')]],
      })
    );
  }

  removeEmergencyContact(index: number) {
    this.emergencyContacts.removeAt(index);
  }

  onSubmit() {
    if (this.studentForm.valid) {
      console.log('Form Data:', this.studentForm.value);
    } else {
      console.error('Form is invalid');
    }
  }
}